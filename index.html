<!--
  SocialExplorer.ml
  Copyright Â© 2019-2022 Blue Forest

  Repository: https://github.com/blue-forest/socialexplorer

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU Affero General Public License as published
  by the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
  GNU Affero General Public License for more details.

  You should have received a copy of the GNU Affero General Public License
  along with this program. If not, see <https://www.gnu.org/licenses/>.
-->
<!DOCTYPE html>
<html>
<head>
  <title>SocialExplorer</title>
  <script type="module">
    const wasm = await WebAssembly.instantiateStreaming(
      fetch(new URL("script.wasm", import.meta.url)),
      {
        env: Object.assign(Object.create(globalThis), {
          abort(message, fileName, lineNumber, columnNumber) {
            // ~lib/builtins/abort(~lib/string/String | null?, ~lib/string/String | null?, u32?, u32?) => void
            message = __liftString(message >>> 0);
            fileName = __liftString(fileName >>> 0);
            lineNumber = lineNumber >>> 0;
            columnNumber = columnNumber >>> 0;
            (() => {
              // @external.js
              throw Error(`${message} in ${fileName}:${lineNumber}:${columnNumber}`);
            })();
          },
        }),
        index: {
          fetch(url) {
            // assembly/index/fetch(~lib/string/String) => ~lib/object/Object
            url = __liftString(url >>> 0);
            return __lowerRecord0(__module0.fetch(url)) || __notnull();
          },
        }
      },
    )
    const { memory, add } = wasm.instance.exports
    document.body.innerText = add(320, 100)
  </script>
</head>
<body></body>
</html>
